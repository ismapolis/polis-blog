---
import HeadContent from "@components/HeadContent.astro";
import Header from "@components/Header.astro";
import Footer from "@components/Footer.astro";
import ScrollToTop from "@components/ScrollToTop.astro";
import StructuredData from "@components/StructuredData.astro";
import PerformanceMonitor from "@components/PerformanceMonitor.astro";
import { CONFIG } from "../config";

const { title = CONFIG.site_title, description = CONFIG.description, image = "/og-default.jpg" } = Astro.props;
---

<!doctype html>
<html lang="en-us" style="background-color: #0f0e17">
  <head>
    <HeadContent title={title} description={description} image={image} />
    <meta name="view-transition" content="same-origin" />
    <StructuredData 
      type="website" 
      title={title} 
      description={description} 
      url={Astro.url.pathname} 
    />
  </head>
  <body style="background-color: #0f0e17">
    <Header />
    <main transition:name="page-content">
      <slot/>
    </main>
    <Footer />
    <ScrollToTop />
    <PerformanceMonitor />
  </body>
  <script>
    // Register service worker for PWA
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js')
          .then((registration) => {
            console.log('SW registered: ', registration);
          })
          .catch((registrationError) => {
            console.log('SW registration failed: ', registrationError);
          });
      });
    }
  </script>
</html>
